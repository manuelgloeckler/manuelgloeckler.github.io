




<html lang="en">
  
  <head>
    
      <meta charset="utf-8">
      <title>Bokeh Plot</title>
      
      
        
          
        
        
          
        <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-2.4.2.min.js"></script>
        <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.2.min.js"></script>
        <script type="text/javascript">
            Bokeh.set_log_level("info");
        </script>
        
      
      
    
  </head>
  
  
  <body>
    
      
        
          
          
            
              <div class="bk-root" id="bba7e2ab-553b-4a01-bdce-3ecb7f938478" data-root-id="2199"></div>
            
          
        
      
      
        <script type="application/json" id="2515">
          {"4ed3261b-1c04-485f-9138-7780bd18f7ba":{"defs":[],"roots":{"references":[{"attributes":{"children":[{"id":"2198"},{"id":"2196"},{"id":"2197"},{"id":"2194"},{"id":"2146"}]},"id":"2199","type":"Column"},{"attributes":{"fill_color":{"value":"red"},"hatch_color":{"value":"red"},"line_color":{"value":"red"},"x":{"field":"o_x"},"y":{"field":"o_y"}},"id":"2184","type":"Scatter"},{"attributes":{},"id":"2166","type":"SaveTool"},{"attributes":{},"id":"2253","type":"UnionRenderers"},{"attributes":{"fill_alpha":{"value":0.5},"fill_color":{"value":"#1f77b4"},"hatch_alpha":{"value":0.5},"line_alpha":{"value":0.5},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"2178","type":"Scatter"},{"attributes":{},"id":"2153","type":"LinearScale"},{"attributes":{"end":10,"js_property_callbacks":{"change:value":[{"id":"2193"}]},"start":0.01,"step":0.001,"title":"alpha","value":1},"id":"2194","type":"Slider"},{"attributes":{"button_type":"success","icon":null,"js_property_callbacks":{"change:active":[{"id":"2189"}]},"label":"\u25ba Play","width":320},"id":"2198","type":"Toggle"},{"attributes":{"icon":null,"js_event_callbacks":{"button_click":[{"id":"2192"}]},"label":"Reset observations","width":320},"id":"2197","type":"Button"},{"attributes":{"below":[{"id":"2155"}],"center":[{"id":"2158"},{"id":"2162"}],"height":500,"js_event_callbacks":{"doubletap":[{"id":"2190"}],"tap":[{"id":"2190"}]},"left":[{"id":"2159"}],"renderers":[{"id":"2181"},{"id":"2187"}],"title":{"id":"2245"},"toolbar":{"id":"2170"},"width":800,"x_range":{"id":"2147"},"x_scale":{"id":"2151"},"y_range":{"id":"2149"},"y_scale":{"id":"2153"}},"id":"2146","subtype":"Figure","type":"Plot"},{"attributes":{},"id":"2164","type":"WheelZoomTool"},{"attributes":{"data":{"o_x":[],"o_y":[]},"selected":{"id":"2256"},"selection_policy":{"id":"2255"}},"id":"2144","type":"ColumnDataSource"},{"attributes":{},"id":"2156","type":"BasicTicker"},{"attributes":{"bottom_units":"screen","coordinates":null,"fill_alpha":0.5,"fill_color":"lightgrey","group":null,"left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"right_units":"screen","syncable":false,"top_units":"screen"},"id":"2169","type":"BoxAnnotation"},{"attributes":{"end":5,"start":-5},"id":"2147","type":"DataRange1d"},{"attributes":{"args":{"source":{"id":"2143"},"source2":{"id":"2144"}},"code":"\n\n    function rnormal() {\n            var u = 0, v = 0;\n            while(u === 0) u = Math.random(); \n            while(v === 0) v = Math.random();\n            return Math.sqrt( -2.0 * Math.log( u ) ) * Math.cos( 2.0 * Math.PI * v );\n        }\n\n    function sum(nums) {\n      var accumulator = 0;\n      for (var i = 0, l = nums.length; i &lt; l; i++)\n        accumulator += nums[i];\n      return accumulator;\n    }\n\n    function rbeta(alpha, beta) {\n      var alpha_gamma = rgamma(alpha, 1);\n      return alpha_gamma / (alpha_gamma + rgamma(beta, 1));\n    }\n\n    var SG_MAGICCONST = 1 + Math.log(4.5);\n    var LOG4 = Math.log(4.0);\n\n    function rgamma(alpha, beta) {\n      if (alpha &gt; 1) {\n        var ainv = Math.sqrt(2.0 * alpha - 1.0);\n        var bbb = alpha - LOG4;\n        var ccc = alpha + ainv;\n\n        while (true) {\n          var u1 = Math.random();\n          if (!((1e-7 &lt; u1) &amp;&amp; (u1 &lt; 0.9999999))) {\n            continue;\n          }\n          var u2 = 1.0 - Math.random();\n          var v = Math.log(u1/(1.0-u1))/ainv;\n          var x = alpha*Math.exp(v);\n          var z = u1*u1*u2;\n          var r = bbb+ccc*v-x;\n          if (r + SG_MAGICCONST - 4.5*z &gt;= 0.0 || r &gt;= Math.log(z)) {\n            return x * beta;\n          }\n        }\n      }\n      else if (alpha == 1.0) {\n        var u = Math.random();\n        while (u &lt;= 1e-7) {\n          u = Math.random();\n        }\n        return -Math.log(u) * beta;\n      }\n      else { \n        while (true) {\n          var u3 = Math.random();\n          var b = (Math.E + alpha)/Math.E;\n          var p = b*u3;\n          if (p &lt;= 1.0) {\n            var x = Math.pow(p, (1.0/alpha));\n          }\n          else {\n            var x = -Math.log((b-p)/alpha);\n          }\n          var u4 = Math.random();\n          if (p &gt; 1.0) {\n            if (u4 &lt;= Math.pow(x, (alpha - 1.0))) {\n              break;\n            }\n          }\n          else if (u4 &lt;= Math.exp(-x)) {\n            break;\n          }\n        }\n        return x * beta;\n      }\n    }\n    \n    function rdirichlet(alpha) {\n      var gammas = [];\n      for (var i = 0, l = alpha.length; i &lt; l; i++)\n        gammas.push(rgamma(alpha[i], 1));\n        \n      var accum = sum(gammas)\n      \n      for (var i = 0, l = gammas.length; i &lt; l; i++)\n        gammas[i] = gammas[i]/accum\n      return gammas\n    }\n    \n    function rcategorical(pi){\n      var u = Math.random();\n      var k = 0\n      var cum = pi[0]\n      for (var i = 1, l = pi.length; i &lt; l; i++)\n        if (u &lt;= cum){\n            break;\n        }\n        else{\n            cum = cum + pi[i]\n            k = k+1\n        }\n      return k\n    }\n      \n    \n\n    const data2 = source2.data;\n    const data = source.data;\n\n    data['x'] = []\n    data['y'] = []\n    data['z'] = []\n\n    source2.change.emit();\n    source.change.emit();\n    \n"},"id":"2191","type":"CustomJS"},{"attributes":{},"id":"2163","type":"PanTool"},{"attributes":{},"id":"2258","type":"Selection"},{"attributes":{"data":{"value":[1.0]},"selected":{"id":"2258"},"selection_policy":{"id":"2257"}},"id":"2145","type":"ColumnDataSource"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"value":"#1f77b4"},"hatch_alpha":{"value":0.2},"line_alpha":{"value":0.2},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"2180","type":"Scatter"},{"attributes":{"tools":[{"id":"2163"},{"id":"2164"},{"id":"2165"},{"id":"2166"},{"id":"2167"},{"id":"2168"}]},"id":"2170","type":"Toolbar"},{"attributes":{"overlay":{"id":"2169"}},"id":"2165","type":"BoxZoomTool"},{"attributes":{},"id":"2257","type":"UnionRenderers"},{"attributes":{"args":{"source":{"id":"2143"},"source3":{"id":"2145"}},"code":"\n\n    function rnormal() {\n            var u = 0, v = 0;\n            while(u === 0) u = Math.random(); \n            while(v === 0) v = Math.random();\n            return Math.sqrt( -2.0 * Math.log( u ) ) * Math.cos( 2.0 * Math.PI * v );\n        }\n\n    function sum(nums) {\n      var accumulator = 0;\n      for (var i = 0, l = nums.length; i &lt; l; i++)\n        accumulator += nums[i];\n      return accumulator;\n    }\n\n    function rbeta(alpha, beta) {\n      var alpha_gamma = rgamma(alpha, 1);\n      return alpha_gamma / (alpha_gamma + rgamma(beta, 1));\n    }\n\n    var SG_MAGICCONST = 1 + Math.log(4.5);\n    var LOG4 = Math.log(4.0);\n\n    function rgamma(alpha, beta) {\n      if (alpha &gt; 1) {\n        var ainv = Math.sqrt(2.0 * alpha - 1.0);\n        var bbb = alpha - LOG4;\n        var ccc = alpha + ainv;\n\n        while (true) {\n          var u1 = Math.random();\n          if (!((1e-7 &lt; u1) &amp;&amp; (u1 &lt; 0.9999999))) {\n            continue;\n          }\n          var u2 = 1.0 - Math.random();\n          var v = Math.log(u1/(1.0-u1))/ainv;\n          var x = alpha*Math.exp(v);\n          var z = u1*u1*u2;\n          var r = bbb+ccc*v-x;\n          if (r + SG_MAGICCONST - 4.5*z &gt;= 0.0 || r &gt;= Math.log(z)) {\n            return x * beta;\n          }\n        }\n      }\n      else if (alpha == 1.0) {\n        var u = Math.random();\n        while (u &lt;= 1e-7) {\n          u = Math.random();\n        }\n        return -Math.log(u) * beta;\n      }\n      else { \n        while (true) {\n          var u3 = Math.random();\n          var b = (Math.E + alpha)/Math.E;\n          var p = b*u3;\n          if (p &lt;= 1.0) {\n            var x = Math.pow(p, (1.0/alpha));\n          }\n          else {\n            var x = -Math.log((b-p)/alpha);\n          }\n          var u4 = Math.random();\n          if (p &gt; 1.0) {\n            if (u4 &lt;= Math.pow(x, (alpha - 1.0))) {\n              break;\n            }\n          }\n          else if (u4 &lt;= Math.exp(-x)) {\n            break;\n          }\n        }\n        return x * beta;\n      }\n    }\n    \n    function rdirichlet(alpha) {\n      var gammas = [];\n      for (var i = 0, l = alpha.length; i &lt; l; i++)\n        gammas.push(rgamma(alpha[i], 1));\n        \n      var accum = sum(gammas)\n      \n      for (var i = 0, l = gammas.length; i &lt; l; i++)\n        gammas[i] = gammas[i]/accum\n      return gammas\n    }\n    \n    function rcategorical(pi){\n      var u = Math.random();\n      var k = 0\n      var cum = pi[0]\n      for (var i = 1, l = pi.length; i &lt; l; i++)\n        if (u &lt;= cum){\n            break;\n        }\n        else{\n            cum = cum + pi[i]\n            k = k+1\n        }\n      return k\n    }\n      \n    \n\n\n    const data = source.data;\n    const slider = source3.data\n\n    slider.value[0] = cb_obj.value\n    data['x'] = []\n    data['y'] = []\n    data['z'] = []\n\n    source.change.emit();\n    source3.change.emit();\n    \n"},"id":"2193","type":"CustomJS"},{"attributes":{},"id":"2256","type":"Selection"},{"attributes":{},"id":"2151","type":"LinearScale"},{"attributes":{"args":{"source":{"id":"2143"},"source2":{"id":"2144"},"source3":{"id":"2145"}},"code":"\n\n    function rnormal() {\n            var u = 0, v = 0;\n            while(u === 0) u = Math.random(); \n            while(v === 0) v = Math.random();\n            return Math.sqrt( -2.0 * Math.log( u ) ) * Math.cos( 2.0 * Math.PI * v );\n        }\n\n    function sum(nums) {\n      var accumulator = 0;\n      for (var i = 0, l = nums.length; i &lt; l; i++)\n        accumulator += nums[i];\n      return accumulator;\n    }\n\n    function rbeta(alpha, beta) {\n      var alpha_gamma = rgamma(alpha, 1);\n      return alpha_gamma / (alpha_gamma + rgamma(beta, 1));\n    }\n\n    var SG_MAGICCONST = 1 + Math.log(4.5);\n    var LOG4 = Math.log(4.0);\n\n    function rgamma(alpha, beta) {\n      if (alpha &gt; 1) {\n        var ainv = Math.sqrt(2.0 * alpha - 1.0);\n        var bbb = alpha - LOG4;\n        var ccc = alpha + ainv;\n\n        while (true) {\n          var u1 = Math.random();\n          if (!((1e-7 &lt; u1) &amp;&amp; (u1 &lt; 0.9999999))) {\n            continue;\n          }\n          var u2 = 1.0 - Math.random();\n          var v = Math.log(u1/(1.0-u1))/ainv;\n          var x = alpha*Math.exp(v);\n          var z = u1*u1*u2;\n          var r = bbb+ccc*v-x;\n          if (r + SG_MAGICCONST - 4.5*z &gt;= 0.0 || r &gt;= Math.log(z)) {\n            return x * beta;\n          }\n        }\n      }\n      else if (alpha == 1.0) {\n        var u = Math.random();\n        while (u &lt;= 1e-7) {\n          u = Math.random();\n        }\n        return -Math.log(u) * beta;\n      }\n      else { \n        while (true) {\n          var u3 = Math.random();\n          var b = (Math.E + alpha)/Math.E;\n          var p = b*u3;\n          if (p &lt;= 1.0) {\n            var x = Math.pow(p, (1.0/alpha));\n          }\n          else {\n            var x = -Math.log((b-p)/alpha);\n          }\n          var u4 = Math.random();\n          if (p &gt; 1.0) {\n            if (u4 &lt;= Math.pow(x, (alpha - 1.0))) {\n              break;\n            }\n          }\n          else if (u4 &lt;= Math.exp(-x)) {\n            break;\n          }\n        }\n        return x * beta;\n      }\n    }\n    \n    function rdirichlet(alpha) {\n      var gammas = [];\n      for (var i = 0, l = alpha.length; i &lt; l; i++)\n        gammas.push(rgamma(alpha[i], 1));\n        \n      var accum = sum(gammas)\n      \n      for (var i = 0, l = gammas.length; i &lt; l; i++)\n        gammas[i] = gammas[i]/accum\n      return gammas\n    }\n    \n    function rcategorical(pi){\n      var u = Math.random();\n      var k = 0\n      var cum = pi[0]\n      for (var i = 1, l = pi.length; i &lt; l; i++)\n        if (u &lt;= cum){\n            break;\n        }\n        else{\n            cum = cum + pi[i]\n            k = k+1\n        }\n      return k\n    }\n      \n    \n    const data = source.data;\n    const data2 = source2.data\n    const slider = source3.data \n    \n\n    var x = data['x']\n    var y = data['y']\n    var zs = data['z']\n    var x_o = data2[\"o_x\"]\n    var y_o = data2[\"o_y\"]\n\n    var N = x_o.length \n    var alpha_0 = slider.value[0] \n    var alpha = slider.value[0] + N\n    \n\n    var vs = [rbeta(1,alpha)]\n    var pi = vs.concat([1-vs[0]])\n    var means_x = []\n    var means_y = []\n    var p1 = alpha_0/(alpha_0 + N)\n    var p2 = N/(alpha_0 + N)\n    var dist = [p1, p2]\n    var res = rcategorical(dist)\n    console.log(alpha_0)\n    console.log(alpha)\n    if (res == 0){\n        means_x.push(rnormal())\n        means_y.push(rnormal())\n    }\n    else{\n        var help_p = []\n        for (let i = 0; i &lt; N; i++) {\n            help_p.push(1/N)\n    }\n        var j = rcategorical(help_p)\n        means_x.push(x_o[j])\n        means_y.push(y_o[j])\n    }\n    var seen_cluster = [0]\n    var i = 0\n    var z = 0\n    var new_prob = 1\n    var old_slider_val = slider.value[0]\n    \n\n    function update() {\n        console.log(alpha)\n        console.log(alpha_0)\n        if ((old_slider_val != slider.value[0]) &amp;&amp;  (x.length &gt; 0))  {\n            alpha_0 = slider.value[0] \n            alpha = slider.value[0]+ N\n            vs = [rbeta(1,alpha)]\n            pi = vs.concat([1-vs[0]])\n            var p1 = alpha_0/(alpha_0 + N)\n            var p2 = N/(alpha_0 + N)\n            var dist = [p1, p2]\n            var res = rcategorical(dist)\n            console.log(alpha_0)\n            console.log(alpha)\n            if (res == 0){\n                means_x.push(rnormal())\n                means_y.push(rnormal())\n            }\n            else{\n                var help_p = []\n                for (let i = 0; i &lt; N; i++) {\n                    help_p.push(1/N)\n            }\n                var j = rcategorical(help_p)\n                means_x.push(x_o[j])\n                means_y.push(y_o[j])\n            }\n            seen_cluster = [0]\n            i = 0\n            z = 0\n        \n            data[\"x\"] = []\n            data[\"y\"] = []\n            data[\"z\"] = []\n            x = []\n            y = []\n            z = []\n            cb_obj.active = false\n            source.change.emit();\n            old_slider_val = slider.value[0]\n            return;\n        }\n\n        if (!(cb_obj.active)){\n            return;\n        }\n\n\n        \n        \n        i = i + 1;\n        z = rcategorical(pi);\n        \n       \n        if (seen_cluster.includes(z)){\n\n            x.push(means_x[z]+ rnormal()*0.1);\n            y.push(means_y[z]+ rnormal()*0.1);\n            zs.push(seen_cluster.indexOf(z))\n        }\n        else{\n            vs.push(rbeta(1,alpha))\n            new_prob = 1\n            for (let i = 0; i &lt; vs.length-1; i++) {\n                new_prob = new_prob*(1-vs[i])\n            }\n            new_prob = new_prob*vs[vs.length-1]\n            pi[pi.length-1] = new_prob\n            pi = pi.concat([1-sum(pi)])\n        \n            seen_cluster.push(z)\n\n            var p1 = alpha_0/(alpha_0 + N)\n            var p2 = N/(alpha_0 + N)\n            var dist = [p1, p2]\n            var res = rcategorical(dist)\n\n            if (res == 0){\n                means_x.push(rnormal())\n                means_y.push(rnormal())\n            }\n            else{\n                var help_p = []\n                for (let i = 0; i &lt; N; i++) {\n                    help_p.push(1/N)\n            }\n                var j = rcategorical(help_p)\n                means_x.push(x_o[j])\n                means_y.push(y_o[j])\n            }\n\n            x.push(means_x[z] + rnormal()*0.1);\n            y.push(means_y[z] + rnormal()*0.1);\n            zs.push(seen_cluster.indexOf(z))\n        }  \n        source.change.emit();\n    }\n    \n    if ((x.length == 0)){\n        var looop = setInterval(update, 10);\n    }\n\n    if(cb_obj.active == false){\n        cb_obj.label = '\u25ba Play';\n    }\n    else {\n        cb_obj.label = '\u275a\u275a Pause';\n\n    }\n    \n"},"id":"2189","type":"CustomJS"},{"attributes":{"source":{"id":"2143"}},"id":"2182","type":"CDSView"},{"attributes":{},"id":"2248","type":"BasicTickFormatter"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"red"},"hatch_alpha":{"value":0.1},"hatch_color":{"value":"red"},"line_alpha":{"value":0.1},"line_color":{"value":"red"},"x":{"field":"o_x"},"y":{"field":"o_y"}},"id":"2185","type":"Scatter"},{"attributes":{},"id":"2255","type":"UnionRenderers"},{"attributes":{"data":{"x":[],"y":[],"z":[]},"selected":{"id":"2254"},"selection_policy":{"id":"2253"}},"id":"2143","type":"ColumnDataSource"},{"attributes":{"args":{"source2":{"id":"2144"}},"code":"\n\n    function rnormal() {\n            var u = 0, v = 0;\n            while(u === 0) u = Math.random(); \n            while(v === 0) v = Math.random();\n            return Math.sqrt( -2.0 * Math.log( u ) ) * Math.cos( 2.0 * Math.PI * v );\n        }\n\n    function sum(nums) {\n      var accumulator = 0;\n      for (var i = 0, l = nums.length; i &lt; l; i++)\n        accumulator += nums[i];\n      return accumulator;\n    }\n\n    function rbeta(alpha, beta) {\n      var alpha_gamma = rgamma(alpha, 1);\n      return alpha_gamma / (alpha_gamma + rgamma(beta, 1));\n    }\n\n    var SG_MAGICCONST = 1 + Math.log(4.5);\n    var LOG4 = Math.log(4.0);\n\n    function rgamma(alpha, beta) {\n      if (alpha &gt; 1) {\n        var ainv = Math.sqrt(2.0 * alpha - 1.0);\n        var bbb = alpha - LOG4;\n        var ccc = alpha + ainv;\n\n        while (true) {\n          var u1 = Math.random();\n          if (!((1e-7 &lt; u1) &amp;&amp; (u1 &lt; 0.9999999))) {\n            continue;\n          }\n          var u2 = 1.0 - Math.random();\n          var v = Math.log(u1/(1.0-u1))/ainv;\n          var x = alpha*Math.exp(v);\n          var z = u1*u1*u2;\n          var r = bbb+ccc*v-x;\n          if (r + SG_MAGICCONST - 4.5*z &gt;= 0.0 || r &gt;= Math.log(z)) {\n            return x * beta;\n          }\n        }\n      }\n      else if (alpha == 1.0) {\n        var u = Math.random();\n        while (u &lt;= 1e-7) {\n          u = Math.random();\n        }\n        return -Math.log(u) * beta;\n      }\n      else { \n        while (true) {\n          var u3 = Math.random();\n          var b = (Math.E + alpha)/Math.E;\n          var p = b*u3;\n          if (p &lt;= 1.0) {\n            var x = Math.pow(p, (1.0/alpha));\n          }\n          else {\n            var x = -Math.log((b-p)/alpha);\n          }\n          var u4 = Math.random();\n          if (p &gt; 1.0) {\n            if (u4 &lt;= Math.pow(x, (alpha - 1.0))) {\n              break;\n            }\n          }\n          else if (u4 &lt;= Math.exp(-x)) {\n            break;\n          }\n        }\n        return x * beta;\n      }\n    }\n    \n    function rdirichlet(alpha) {\n      var gammas = [];\n      for (var i = 0, l = alpha.length; i &lt; l; i++)\n        gammas.push(rgamma(alpha[i], 1));\n        \n      var accum = sum(gammas)\n      \n      for (var i = 0, l = gammas.length; i &lt; l; i++)\n        gammas[i] = gammas[i]/accum\n      return gammas\n    }\n    \n    function rcategorical(pi){\n      var u = Math.random();\n      var k = 0\n      var cum = pi[0]\n      for (var i = 1, l = pi.length; i &lt; l; i++)\n        if (u &lt;= cum){\n            break;\n        }\n        else{\n            cum = cum + pi[i]\n            k = k+1\n        }\n      return k\n    }\n      \n    \n\n    const data = source2.data;\n\n    var x = cb_obj[\"x\"];\n    var y = cb_obj[\"y\"];\n\n    data[\"o_x\"].push(x)\n    data[\"o_y\"].push(y)\n\n\n    source2.change.emit();\n"},"id":"2190","type":"CustomJS"},{"attributes":{"coordinates":null,"group":null},"id":"2245","type":"Title"},{"attributes":{"source":{"id":"2144"}},"id":"2188","type":"CDSView"},{"attributes":{"axis":{"id":"2159"},"coordinates":null,"dimension":1,"group":null,"ticker":null},"id":"2162","type":"Grid"},{"attributes":{},"id":"2160","type":"BasicTicker"},{"attributes":{"args":{"source":{"id":"2143"},"source2":{"id":"2144"}},"code":"\n\n    function rnormal() {\n            var u = 0, v = 0;\n            while(u === 0) u = Math.random(); \n            while(v === 0) v = Math.random();\n            return Math.sqrt( -2.0 * Math.log( u ) ) * Math.cos( 2.0 * Math.PI * v );\n        }\n\n    function sum(nums) {\n      var accumulator = 0;\n      for (var i = 0, l = nums.length; i &lt; l; i++)\n        accumulator += nums[i];\n      return accumulator;\n    }\n\n    function rbeta(alpha, beta) {\n      var alpha_gamma = rgamma(alpha, 1);\n      return alpha_gamma / (alpha_gamma + rgamma(beta, 1));\n    }\n\n    var SG_MAGICCONST = 1 + Math.log(4.5);\n    var LOG4 = Math.log(4.0);\n\n    function rgamma(alpha, beta) {\n      if (alpha &gt; 1) {\n        var ainv = Math.sqrt(2.0 * alpha - 1.0);\n        var bbb = alpha - LOG4;\n        var ccc = alpha + ainv;\n\n        while (true) {\n          var u1 = Math.random();\n          if (!((1e-7 &lt; u1) &amp;&amp; (u1 &lt; 0.9999999))) {\n            continue;\n          }\n          var u2 = 1.0 - Math.random();\n          var v = Math.log(u1/(1.0-u1))/ainv;\n          var x = alpha*Math.exp(v);\n          var z = u1*u1*u2;\n          var r = bbb+ccc*v-x;\n          if (r + SG_MAGICCONST - 4.5*z &gt;= 0.0 || r &gt;= Math.log(z)) {\n            return x * beta;\n          }\n        }\n      }\n      else if (alpha == 1.0) {\n        var u = Math.random();\n        while (u &lt;= 1e-7) {\n          u = Math.random();\n        }\n        return -Math.log(u) * beta;\n      }\n      else { \n        while (true) {\n          var u3 = Math.random();\n          var b = (Math.E + alpha)/Math.E;\n          var p = b*u3;\n          if (p &lt;= 1.0) {\n            var x = Math.pow(p, (1.0/alpha));\n          }\n          else {\n            var x = -Math.log((b-p)/alpha);\n          }\n          var u4 = Math.random();\n          if (p &gt; 1.0) {\n            if (u4 &lt;= Math.pow(x, (alpha - 1.0))) {\n              break;\n            }\n          }\n          else if (u4 &lt;= Math.exp(-x)) {\n            break;\n          }\n        }\n        return x * beta;\n      }\n    }\n    \n    function rdirichlet(alpha) {\n      var gammas = [];\n      for (var i = 0, l = alpha.length; i &lt; l; i++)\n        gammas.push(rgamma(alpha[i], 1));\n        \n      var accum = sum(gammas)\n      \n      for (var i = 0, l = gammas.length; i &lt; l; i++)\n        gammas[i] = gammas[i]/accum\n      return gammas\n    }\n    \n    function rcategorical(pi){\n      var u = Math.random();\n      var k = 0\n      var cum = pi[0]\n      for (var i = 1, l = pi.length; i &lt; l; i++)\n        if (u &lt;= cum){\n            break;\n        }\n        else{\n            cum = cum + pi[i]\n            k = k+1\n        }\n      return k\n    }\n      \n    \n\n\n    const data2 = source2.data;\n    const data = source.data;\n\n    data['x'] = []\n    data['y'] = []\n    data['z'] = []\n    data2[\"o_x\"] = []\n    data2[\"o_y\"] = []\n\n    source2.change.emit();\n    source.change.emit();\n    \n"},"id":"2192","type":"CustomJS"},{"attributes":{},"id":"2252","type":"AllLabels"},{"attributes":{"axis":{"id":"2155"},"coordinates":null,"group":null,"ticker":null},"id":"2158","type":"Grid"},{"attributes":{"fill_alpha":{"value":0.1},"fill_color":{"value":"#1f77b4"},"hatch_alpha":{"value":0.1},"line_alpha":{"value":0.1},"line_color":{"value":"#1f77b4"},"x":{"field":"x"},"y":{"field":"y"}},"id":"2179","type":"Scatter"},{"attributes":{"fill_alpha":{"value":0.2},"fill_color":{"value":"red"},"hatch_alpha":{"value":0.2},"hatch_color":{"value":"red"},"line_alpha":{"value":0.2},"line_color":{"value":"red"},"x":{"field":"o_x"},"y":{"field":"o_y"}},"id":"2186","type":"Scatter"},{"attributes":{"coordinates":null,"formatter":{"id":"2248"},"group":null,"major_label_policy":{"id":"2249"},"ticker":{"id":"2160"}},"id":"2159","type":"LinearAxis"},{"attributes":{},"id":"2251","type":"BasicTickFormatter"},{"attributes":{"coordinates":null,"formatter":{"id":"2251"},"group":null,"major_label_policy":{"id":"2252"},"ticker":{"id":"2156"}},"id":"2155","type":"LinearAxis"},{"attributes":{},"id":"2254","type":"Selection"},{"attributes":{},"id":"2168","type":"HelpTool"},{"attributes":{},"id":"2249","type":"AllLabels"},{"attributes":{},"id":"2167","type":"ResetTool"},{"attributes":{"coordinates":null,"data_source":{"id":"2144"},"glyph":{"id":"2184"},"group":null,"hover_glyph":null,"muted_glyph":{"id":"2186"},"nonselection_glyph":{"id":"2185"},"view":{"id":"2188"}},"id":"2187","type":"GlyphRenderer"},{"attributes":{"end":5,"start":-5},"id":"2149","type":"DataRange1d"},{"attributes":{"coordinates":null,"data_source":{"id":"2143"},"glyph":{"id":"2178"},"group":null,"hover_glyph":null,"muted_glyph":{"id":"2180"},"nonselection_glyph":{"id":"2179"},"view":{"id":"2182"}},"id":"2181","type":"GlyphRenderer"},{"attributes":{"icon":null,"js_event_callbacks":{"button_click":[{"id":"2191"}]},"label":"Reset samples","width":320},"id":"2196","type":"Button"}],"root_ids":["2199"]},"title":"Bokeh Application","version":"2.4.2"}}
        </script>
        <script type="text/javascript">
          (function() {
            const fn = function() {
              Bokeh.safely(function() {
                (function(root) {
                  function embed_document(root) {
                    
                  const docs_json = document.getElementById('2515').textContent;
                  const render_items = [{"docid":"4ed3261b-1c04-485f-9138-7780bd18f7ba","root_ids":["2199"],"roots":{"2199":"bba7e2ab-553b-4a01-bdce-3ecb7f938478"}}];
                  root.Bokeh.embed.embed_items(docs_json, render_items);
                
                  }
                  if (root.Bokeh !== undefined) {
                    embed_document(root);
                  } else {
                    let attempts = 0;
                    const timer = setInterval(function(root) {
                      if (root.Bokeh !== undefined) {
                        clearInterval(timer);
                        embed_document(root);
                      } else {
                        attempts++;
                        if (attempts > 100) {
                          clearInterval(timer);
                          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                        }
                      }
                    }, 10, root)
                  }
                })(window);
              });
            };
            if (document.readyState != "loading") fn();
            else document.addEventListener("DOMContentLoaded", fn);
          })();
        </script>
    
  </body>
  
</html>